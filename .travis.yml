language: generic

sudo: false

env:
  global:
  - INSTALL_DIR: $HOME/.local
  - ISABELLE_VERSION: Isabelle2016
  - ISABELLE_TARBALL: ${ISABELLE_VERSION}_app.tar.gz
  - ISABELLE_URL: http://isabelle.in.tum.de/dist/${ISABELLE_TARBALL}
  - ISABELLE_DIR: ${INSTALL_DIR}/${ISABELLE_VERSION}
  - ISABELLE: ${ISABELLE_DIR}/bin/isabelle

cache:
  directories:
  - ${INSTALL_DIR}
  - ($ISABELLE getenv -b ISABELLE_HOME_USER)

before_install:
  - mkdir -p ${INSTALL_DIR}
  - test -e $ISABELLE || wget ${ISABELLE_URL} && tar -C ${INSTALL_DIR}/ -xzf ${ISABELLE_TARBALL}
  - test -e `$ISABELLE getenv -b ISABELLE_HOME`/heaps/`$ISABELLE getenv -b ISABELLE_SYSTEM`_`$ISABELLE getenv -b ISABELLE_PLATFORM`/HOL || $ISABELLE build -b -s -v HOL

install: true

script: $ISABELLE build -d . isabelle-ci-test
